var f=null,g=this;Math.random();var k=function(a,d){var c=a.split("."),b=g;!(c[0]in b)&&b.execScript&&b.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&void 0!==d?b[e]=d:b=b[e]?b[e]:b[e]={}};var m,q=function(a){a=a||[];for(var d=[],c=0,b=a.length;c<b;++c){var e=String(a[c]||"");e&&d.push(e)}if(!d.length)return f;m?m.reset.call(m):m=shindig.sha1();m.update.call(m,d.join(" "));return m.digestString.call(m).toLowerCase()},r=function(a,d,c){this.i=String(a||"");this.e=String(d||"");this.a=String(c||"");this.d={};this.g=this.k=this.f=this.h="";this.c=f};
r.prototype.evaluate=function(){var a={},d="";try{d=String(document.cookie||"")}catch(c){}for(var d=d.split("; ").join(";").split(";"),b=0,e=d.length;b<e;++b){var l=d[b],n=l.indexOf("=");-1!=n?a[l.substr(0,n)]=l.substr(n+1):a[l]=f}this.d=a;if(this.d.SID)if(this.e=this.e.split(".")[0].split("@")[0],a="",a=0==this.i.indexOf("https://")?"SAPISID":"APISID",this.f=String(this.d[a]||""))if(a="",a=0==gadgets.rpc.getOrigin(String(window.location.href)).indexOf("https://")?"SAPISID":"APISID",this.h=String(this.d[a]||
"")){d=String(this.d.LSOLH||"").split(":");b=d.length;if(1==b||4==b)this.k=d[0];if(3==b||4==b)if(a=String(d[b-3]||""),d=String(d[b-1]||""),(b=q([a,this.h]).substr(0,4))&&b==d)this.g=a;this.a&&(a=this.a.indexOf("."),-1!=a&&(a=this.a.substr(0,a)||"",this.a=a+"."+q([this.f,this.i,this.e,this.k,this.g,a]).substr(0,4)));a=q([this.f,this.i,this.e,this.a]);this.a&&(a=a+"."+this.a);this.c=a}else this.c="";else this.c=""};
var s=function(a,d,c){a=new r(a,d,c);a.evaluate();return a},u=function(a,d){var c=t(this),b=f;if(a){a=String(a);var e=a.indexOf(".");-1!=e&&(b=a.substr(e+1))}c=s(c,d,b);return a==c.c},v=function(a,d){var c=t(this),b=s(c);if(String(a)!=b.c)throw Error("Unauthorized request");var e=String(d),c=parseInt(e,10);String(c)!=e||!(0<=c)?c=f:(b=b.g)?(b=b.split("|"),c=b.length<=c?f:b[c]||f):c=f;return c},t=function(a){a=String(a.origin||"");if(!a)throw Error("RPC has no origin.");return a};
k("checkSessionState",u);k("getVersionInfo",v);var w=function(a){window.setTimeout(function(){gadgets.rpc.call("..","oauth2callback:"+gadgets.rpc.getAuthToken(".."),void 0,a)},1)},x=function(){gadgets.rpc.call("..","oauth2relayReady:"+gadgets.rpc.getAuthToken(".."));gadgets.rpc.register("check_session_state",u);gadgets.rpc.register("get_versioninfo",v)};k("oauth2callback",w);
k("oauth2verify",function(a,d){var c=window.open("javascript:void(0);",a),b;if(c&&!c.closed&&(b=c.oauth2callbackUrl))return window.b=window.b||{},window.j=window.j||window.setTimeout,window.setTimeout=function(a,b){try{var d=a,p=!1,h;a=function(){if(!p){p=!0;try{window.b[String(h)]=void 0,delete window.b[String(h)]}catch(a){}return d.call(this)}};var y=c.setTimeout(a,b);h=window.j(a,b);window.b[String(h)]=y;return h}catch(z){}return window.j(a,b)},window.l=window.l||window.clearTimeout,window.clearTimeout=
function(a){try{var b=window.b[String(a)];b&&c.clearTimeout(b)}catch(d){}try{window.b[String(a)]=void 0,delete window.b[String(a)]}catch(p){}window.l(a)},w(String(b)),"keep_open"!=d&&window.setTimeout(function(){c.close()},50),!0;c&&!c.closed&&c.close();return!1});window.addEventListener?window.addEventListener("load",x,!1):window.attachEvent("onload",x);
